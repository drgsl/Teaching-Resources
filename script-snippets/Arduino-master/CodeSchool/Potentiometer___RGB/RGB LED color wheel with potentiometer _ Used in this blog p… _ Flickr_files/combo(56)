YUI.add("timezone-helper",function(t){"use strict";t.TimezoneHelper=function(e,i,s){s?(this.tz=s,this.dst=!1):(this.tz=e.getViewer().prefs.timezonePref.offset,this.dst=e.getViewer().prefs.timezonePref.dst),this.momentObject=t.moment(i,"X"),this.momentObject.utcOffset(this.tz),this.dst&&this.momentObject.isDST()&&this.momentObject.add(1,"hour")},t.TimezoneHelper.prototype.toFormat=function(t){return this.momentObject.format(t)}},"@VERSION@",{requires:["moment"]});YUI.add("subscriptions-helper",function(o){"use strict";o.SubscriptionsHelper=function(){this.FLICKR_PRO_3_MONTH_PLAN_ID=1,this.FLICKR_PRO_1_YEAR_PLAN_ID=2,this.FLICKR_PRO_2_YEARS_PLAN_ID=3,this.FLICKR_PRO_MONTHLY_PLAN_ID=7,this.FLICKR_PRO_ANNUAL_PLAN_ID=8,this.FLICKR_PRO_ANNUAL_TRIAL=9,this.FLICKR_PRO_OLD_ANNUAL_TRIAL=10,this.FLICKR_PRO_ANNUAL_PRICE=49.99,this.FLICKR_PRO_MONTHLY_PRICE=5.99,this.subscriptionsIdByName={"pro-3month":this.FLICKR_PRO_3_MONTH_PLAN_ID,"pro-1year":this.FLICKR_PRO_1_YEAR_PLAN_ID,"pro-2year":this.FLICKR_PRO_2_YEARS_PLAN_ID,"pro-monthly":this.FLICKR_PRO_MONTHLY_PLAN_ID,"pro-annual":this.FLICKR_PRO_ANNUAL_PLAN_ID,"pro-trial":this.FLICKR_PRO_ANNUAL_TRIAL},this.subscriptionStatusMap={initiated:1,active:2,closed:3,canceled:4,failed:5,refunded:6,pending:7,subscription_canceled:8,subscription_charged_successfully:9,subscription_charged_unsuccessfully:10,subscription_expired:11,subscription_went_past_due:12,change_initiated:13,closed_pending:14},this.subscriptionsIdHasAnnualPerk={1:!1,2:!0,3:!0,4:!0,6:!1,7:!1,8:!0,9:!0,10:!0},this.cardTypeMap={1:"visa",2:"master-card",3:"discover",4:"american-express",5:"JCB"},this.paymentVendorMap={braintree:10,oldpaypal:20,digitalriver:30},this.countriesArray=[{countryCode:"US",countryName:"United States"},{countryCode:"AF",countryName:"Afghanistan"},{countryCode:"AX",countryName:"Åland"},{countryCode:"AL",countryName:"Albania"},{countryCode:"DZ",countryName:"Algeria"},{countryCode:"AS",countryName:"American Samoa"},{countryCode:"AD",countryName:"Andorra"},{countryCode:"AO",countryName:"Angola"},{countryCode:"AI",countryName:"Anguilla"},{countryCode:"AQ",countryName:"Antarctica"},{countryCode:"AG",countryName:"Antigua and Barbuda"},{countryCode:"AR",countryName:"Argentina"},{countryCode:"AM",countryName:"Armenia"},{countryCode:"AW",countryName:"Aruba"},{countryCode:"AU",countryName:"Australia"},{countryCode:"AT",countryName:"Austria"},{countryCode:"AZ",countryName:"Azerbaijan"},{countryCode:"BS",countryName:"Bahamas"},{countryCode:"BH",countryName:"Bahrain"},{countryCode:"BD",countryName:"Bangladesh"},{countryCode:"BB",countryName:"Barbados"},{countryCode:"BY",countryName:"Belarus"},{countryCode:"BE",countryName:"Belgium"},{countryCode:"BZ",countryName:"Belize"},{countryCode:"BJ",countryName:"Benin"},{countryCode:"BM",countryName:"Bermuda"},{countryCode:"BT",countryName:"Bhutan"},{countryCode:"BO",countryName:"Bolivia"},{countryCode:"BQ",countryName:"Bonaire, Sint Eustatius and Saba"},{countryCode:"BA",countryName:"Bosnia and Herzegovina"},{countryCode:"BW",countryName:"Botswana"},{countryCode:"BV",countryName:"Bouvet Island"},{countryCode:"BR",countryName:"Brazil"},{countryCode:"IO",countryName:"British Indian Ocean Territory"},{countryCode:"BN",countryName:"Brunei Darussalam"},{countryCode:"BG",countryName:"Bulgaria"},{countryCode:"BF",countryName:"Burkina Faso"},{countryCode:"BI",countryName:"Burundi"},{countryCode:"KH",countryName:"Cambodia"},{countryCode:"CM",countryName:"Cameroon"},{countryCode:"CA",countryName:"Canada"},{countryCode:"CV",countryName:"Cape Verde"},{countryCode:"KY",countryName:"Cayman Islands"},{countryCode:"CF",countryName:"Central African Republic"},{countryCode:"TD",countryName:"Chad"},{countryCode:"CL",countryName:"Chile"},{countryCode:"CN",countryName:"China"},{countryCode:"CX",countryName:"Christmas Island"},{countryCode:"CC",countryName:"Cocos (Keeling) Islands"},{countryCode:"CO",countryName:"Colombia"},{countryCode:"KM",countryName:"Comoros"},{countryCode:"CG",countryName:"Congo (Brazzaville)"},{countryCode:"CD",countryName:"Congo (Kinshasa)"},{countryCode:"CK",countryName:"Cook Islands"},{countryCode:"CR",countryName:"Costa Rica"},{countryCode:"CI",countryName:"Côte d'Ivoire"},{countryCode:"HR",countryName:"Croatia"},{countryCode:"CW",countryName:"Curaçao"},{countryCode:"CY",countryName:"Cyprus"},{countryCode:"CZ",countryName:"Czech Republic"},{countryCode:"DK",countryName:"Denmark"},{countryCode:"DJ",countryName:"Djibouti"},{countryCode:"DM",countryName:"Dominica"},{countryCode:"DO",countryName:"Dominican Republic"},{countryCode:"EC",countryName:"Ecuador"},{countryCode:"EG",countryName:"Egypt"},{countryCode:"SV",countryName:"El Salvador"},{countryCode:"GQ",countryName:"Equatorial Guinea"},{countryCode:"ER",countryName:"Eritrea"},{countryCode:"EE",countryName:"Estonia"},{countryCode:"ET",countryName:"Ethiopia"},{countryCode:"FK",countryName:"Falkland Islands"},{countryCode:"FO",countryName:"Faroe Islands"},{countryCode:"FJ",countryName:"Fiji"},{countryCode:"FI",countryName:"Finland"},{countryCode:"FR",countryName:"France"},{countryCode:"GF",countryName:"French Guiana"},{countryCode:"PF",countryName:"French Polynesia"},{countryCode:"TF",countryName:"French Southern Lands"},{countryCode:"GA",countryName:"Gabon"},{countryCode:"GM",countryName:"Gambia"},{countryCode:"GE",countryName:"Georgia"},{countryCode:"DE",countryName:"Germany"},{countryCode:"GH",countryName:"Ghana"},{countryCode:"GI",countryName:"Gibraltar"},{countryCode:"GR",countryName:"Greece"},{countryCode:"GL",countryName:"Greenland"},{countryCode:"GD",countryName:"Grenada"},{countryCode:"GP",countryName:"Guadeloupe"},{countryCode:"GU",countryName:"Guam"},{countryCode:"GT",countryName:"Guatemala"},{countryCode:"GG",countryName:"Guernsey"},{countryCode:"GN",countryName:"Guinea"},{countryCode:"GW",countryName:"Guinea-Bissau"},{countryCode:"GY",countryName:"Guyana"},{countryCode:"HT",countryName:"Haiti"},{countryCode:"HM",countryName:"Heard and McDonald Islands"},{countryCode:"HN",countryName:"Honduras"},{countryCode:"HK",countryName:"Hong Kong"},{countryCode:"HU",countryName:"Hungary"},{countryCode:"IS",countryName:"Iceland"},{countryCode:"IN",countryName:"India"},{countryCode:"ID",countryName:"Indonesia"},{countryCode:"IE",countryName:"Ireland"},{countryCode:"IM",countryName:"Isle of Man"},{countryCode:"IL",countryName:"Israel"},{countryCode:"IT",countryName:"Italy"},{countryCode:"JM",countryName:"Jamaica"},{countryCode:"JP",countryName:"Japan"},{countryCode:"JE",countryName:"Jersey"},{countryCode:"JO",countryName:"Jordan"},{countryCode:"KZ",countryName:"Kazakhstan"},{countryCode:"KE",countryName:"Kenya"},{countryCode:"KI",countryName:"Kiribati"},{countryCode:"KR",countryName:"Korea, South"},{countryCode:"KW",countryName:"Kuwait"},{countryCode:"KG",countryName:"Kyrgyzstan"},{countryCode:"LA",countryName:"Laos"},{countryCode:"LV",countryName:"Latvia"},{countryCode:"LB",countryName:"Lebanon"},{countryCode:"LS",countryName:"Lesotho"},{countryCode:"LR",countryName:"Liberia"},{countryCode:"LY",countryName:"Libya"},{countryCode:"LI",countryName:"Liechtenstein"},{countryCode:"LT",countryName:"Lithuania"},{countryCode:"LU",countryName:"Luxembourg"},{countryCode:"MO",countryName:"Macau"},{countryCode:"MK",countryName:"Macedonia"},{countryCode:"MG",countryName:"Madagascar"},{countryCode:"MW",countryName:"Malawi"},{countryCode:"MY",countryName:"Malaysia"},{countryCode:"MV",countryName:"Maldives"},{countryCode:"ML",countryName:"Mali"},{countryCode:"MT",countryName:"Malta"},{countryCode:"MH",countryName:"Marshall Islands"},{countryCode:"MQ",countryName:"Martinique"},{countryCode:"MR",countryName:"Mauritania"},{countryCode:"MU",countryName:"Mauritius"},{countryCode:"YT",countryName:"Mayotte"},{countryCode:"MX",countryName:"Mexico"},{countryCode:"FM",countryName:"Micronesia"},{countryCode:"MD",countryName:"Moldova"},{countryCode:"MC",countryName:"Monaco"},{countryCode:"MN",countryName:"Mongolia"},{countryCode:"ME",countryName:"Montenegro"},{countryCode:"MS",countryName:"Montserrat"},{countryCode:"MA",countryName:"Morocco"},{countryCode:"MZ",countryName:"Mozambique"},{countryCode:"MM",countryName:"Myanmar"},{countryCode:"NA",countryName:"Namibia"},{countryCode:"NR",countryName:"Nauru"},{countryCode:"NP",countryName:"Nepal"},{countryCode:"NL",countryName:"Netherlands"},{countryCode:"AN",countryName:"Netherlands Antilles"},{countryCode:"NC",countryName:"New Caledonia"},{countryCode:"NZ",countryName:"New Zealand"},{countryCode:"NI",countryName:"Nicaragua"},{countryCode:"NE",countryName:"Niger"},{countryCode:"NG",countryName:"Nigeria"},{countryCode:"NU",countryName:"Niue"},{countryCode:"NF",countryName:"Norfolk Island"},{countryCode:"MP",countryName:"Northern Mariana Islands"},{countryCode:"NO",countryName:"Norway"},{countryCode:"OM",countryName:"Oman"},{countryCode:"PK",countryName:"Pakistan"},{countryCode:"PW",countryName:"Palau"},{countryCode:"PS",countryName:"Palestine"},{countryCode:"PA",countryName:"Panama"},{countryCode:"PG",countryName:"Papua New Guinea"},{countryCode:"PY",countryName:"Paraguay"},{countryCode:"PE",countryName:"Peru"},{countryCode:"PH",countryName:"Philippines"},{countryCode:"PN",countryName:"Pitcairn"},{countryCode:"PL",countryName:"Poland"},{countryCode:"PT",countryName:"Portugal"},{countryCode:"PR",countryName:"Puerto Rico"},{countryCode:"QA",countryName:"Qatar"},{countryCode:"RE",countryName:"Reunion"},{countryCode:"RO",countryName:"Romania"},{countryCode:"RU",countryName:"Russian Federation"},{countryCode:"RW",countryName:"Rwanda"},{countryCode:"BL",countryName:"Saint Barthélemy"},{countryCode:"SH",countryName:"Saint Helena"},{countryCode:"KN",countryName:"Saint Kitts and Nevis"},{countryCode:"LC",countryName:"Saint Lucia"},{countryCode:"MF",countryName:"Saint Martin (French part)"},{countryCode:"PM",countryName:"Saint Pierre and Miquelon"},{countryCode:"VC",countryName:"Saint Vincent and the Grenadines"},{countryCode:"WS",countryName:"Samoa"},{countryCode:"SM",countryName:"San Marino"},{countryCode:"ST",countryName:"Sao Tome and Principe"},{countryCode:"SA",countryName:"Saudi Arabia"},{countryCode:"SN",countryName:"Senegal"},{countryCode:"RS",countryName:"Serbia"},{countryCode:"SC",countryName:"Seychelles"},{countryCode:"SL",countryName:"Sierra Leone"},{countryCode:"SG",countryName:"Singapore"},{countryCode:"SX",countryName:"Sint Maarten (Dutch part)"},{countryCode:"SK",countryName:"Slovakia"},{countryCode:"SI",countryName:"Slovenia"},{countryCode:"SB",countryName:"Solomon Islands"},{countryCode:"SO",countryName:"Somalia"},{countryCode:"ZA",countryName:"South Africa"},{countryCode:"GS",countryName:"South Georgia and South Sandwich Islands"},{countryCode:"SS",countryName:"South Sudan"},{countryCode:"ES",countryName:"Spain"},{countryCode:"LK",countryName:"Sri Lanka"},{countryCode:"SD",countryName:"Sudan"},{countryCode:"SR",countryName:"Suriname"},{countryCode:"SJ",countryName:"Svalbard and Jan Mayen Islands"},{countryCode:"SZ",countryName:"Swaziland"},{countryCode:"SE",countryName:"Sweden"},{countryCode:"CH",countryName:"Switzerland"},{countryCode:"TW",countryName:"Taiwan"},{countryCode:"TJ",countryName:"Tajikistan"},{countryCode:"TZ",countryName:"Tanzania"},{countryCode:"TH",countryName:"Thailand"},{countryCode:"TL",countryName:"Timor-Leste"},{countryCode:"TG",countryName:"Togo"},{countryCode:"TK",countryName:"Tokelau"},{countryCode:"TO",countryName:"Tonga"},{countryCode:"TT",countryName:"Trinidad and Tobago"},{countryCode:"TN",countryName:"Tunisia"},{countryCode:"TR",countryName:"Turkey"},{countryCode:"TM",countryName:"Turkmenistan"},{countryCode:"TC",countryName:"Turks and Caicos Islands"},{countryCode:"TV",countryName:"Tuvalu"},{countryCode:"UG",countryName:"Uganda"},{countryCode:"UA",countryName:"Ukraine"},{countryCode:"AE",countryName:"United Arab Emirates"},{countryCode:"GB",countryName:"United Kingdom"},{countryCode:"UM",countryName:"United States Minor Outlying Islands"},{countryCode:"UY",countryName:"Uruguay"},{countryCode:"UZ",countryName:"Uzbekistan"},{countryCode:"VU",countryName:"Vanuatu"},{countryCode:"VA",countryName:"Vatican City"},{countryCode:"VE",countryName:"Venezuela"},{countryCode:"VN",countryName:"Vietnam"},{countryCode:"VG",countryName:"Virgin Islands, British"},{countryCode:"VI",countryName:"Virgin Islands, U.S."},{countryCode:"WF",countryName:"Wallis and Futuna Islands"},{countryCode:"EH",countryName:"Western Sahara"},{countryCode:"YE",countryName:"Yemen"},{countryCode:"ZM",countryName:"Zambia"},{countryCode:"ZW",countryName:"Zimbabwe"}]},o.SubscriptionsHelper.prototype.canSeeAnnualProPerks=function(e,t){if(t){var n=t.toJSON();if(!e.getValue("isPro"))return!1;if(n.oneTimePro.isOneTimePro)return!0;if(e.getValue("isPro")){var r=o.Array.filter(n.subscriptions,function(e){return e.status===this.subscriptionStatusMap.active||e.status===this.subscriptionStatusMap.closed&&void 0!==e.effectiveEndDate&&e.effectiveEndDate.isAfter(o.moment())||e.status===this.subscriptionStatusMap.subscription_went_past_due}.bind(this));return!(!r||!r[0])&&this.subscriptionsIdHasAnnualPerk[r[0].type]}}},o.SubscriptionsHelper.prototype.canPlanIdSeeAnnualPerks=function(o){return this.subscriptionsIdHasAnnualPerk[o]},o.SubscriptionsHelper.prototype.convertDesiredPlan=function(o,e,t,n){var r;if(t=!0,e=!1,"pro-3month"===o||"pro-1year"===o||"pro-2year"===o){if(e)r=o;else if(t)switch(o){case"pro-3month":r="pro-monthly";break;case"pro-1year":case"pro-2year":r="pro-annual"}}else if(t)r=o;else if(e)switch(o){case"pro-monthly":r="pro-3month";break;case"pro-annual":r="pro-1year"}return r},o.SubscriptionsHelper.prototype.getPlanIdWithPlanName=function(o){var e=this.FLICKR_PRO_ANNUAL_PLAN_ID;return void 0!==this.subscriptionsIdByName[o]&&(e=this.subscriptionsIdByName[o]),e},o.SubscriptionsHelper.prototype.canPurchaseAtLeastOnePlan=function(o){var e=[];return o&&(e=o.filter(function(o){return 1===o.canPurchase})),e.length>0},o.SubscriptionsHelper.prototype.canPurchaseThisPlanId=function(o,e){var t=[];return o&&e&&(t=e.filter(function(e){return e.planId===o})),t.length>0},o.SubscriptionsHelper.prototype.getNewProPlans=function(o){if(o)return o.filter(function(o){return"FlickrNewPro"===o.familyName})},o.SubscriptionsHelper.prototype.getOldProPlans=function(o){if(o)return o.filter(function(o){return"FlickrPro"===o.familyName})},o.SubscriptionsHelper.prototype.getPlanWithIdInPlansList=function(o){},o.SubscriptionsHelper.prototype.sanitizeCouponCode=function(o){var e=!1;if(o){if(e=o.trim(),o.length<=1)return!1;if(!e.match(/^[\w\-]+$/))return!1}return e},o.SubscriptionsHelper.prototype.convertLocaleToPaypalFormat=function(o){if(o){return{"de-DE":"de_DE","en-US":"en_US","es-US":"es_ES","fr-FR":"fr_FR","id-ID":"id_ID","it-IT":"it_IT","ko-KR":"ko_KR","pt-BR":"pt_PT","vi-VN":"en_US","zh-Hant-HK":"zh_HK"}[o]}},o.SubscriptionsHelper.prototype.getNiceCardType=function(o){return this.cardTypeMap[o]},o.SubscriptionsHelper.prototype.getPaymentVendorType=function(o){return this.paymentVendorMap[o]},o.SubscriptionsHelper.prototype.isPaymentVendorBraintree=function(o){return o===this.paymentVendorMap.braintree},o.SubscriptionsHelper.prototype.isPaymentVendorDigitalRiver=function(o){return o===this.paymentVendorMap.digitalriver},o.SubscriptionsHelper.prototype.hasYearlyLegalNotice=function(o){return this.subscriptionsIdHasAnnualPerk[o]},o.SubscriptionsHelper.prototype.log=function(e,t){!YUI.Env.isServer&&o.config.win.beaconError&&o.config.win.beaconError("[flickr-add-payment-method] "+e,o.config.win.location.href,t||{})},o.SubscriptionsHelper.prototype.beaconTransactionStep=function(e,t){!YUI.Env.isServer&&o.config.win.beaconError&&o.config.win.beaconError("[PRO] "+e,o.config.win.location.href,t||{})},o.SubscriptionsHelper.prototype.doesPlanIdHaveTrial=function(o){return o===this.FLICKR_PRO_ANNUAL_PLAN_ID||o===this.FLICKR_PRO_1_YEAR_PLAN_ID||o===this.FLICKR_PRO_2_YEARS_PLAN_ID},o.SubscriptionsHelper.prototype.canPurchaseTrialPlan=function(e,t){if(e&&t){var n;return n=e.getValue("products"),o.Array.filter(n,function(o){return o.planId===this.FLICKR_PRO_ANNUAL_TRIAL&&1===o.canPurchase||o.planId===this.FLICKR_PRO_OLD_ANNUAL_TRIAL&&1===o.canPurchase}.bind(this)).length>0}},o.SubscriptionsHelper.prototype.getTrialLength=function(){return 45},o.SubscriptionsHelper.prototype.formatSubscriptionModels=function(e){var t=e;return!t||!t.toJSON()||!t.toJSON().subscriptions||!t.toJSON().subscriptions instanceof Array||0===t.toJSON().subscriptions.length?[]:o.Array.map(t.toJSON().subscriptions,function(o){var e,t=o.amountBilled?o.amountBilled.toFixed(2):"0.00",n=o.pendingPrice?o.pendingPrice.toFixed(2):"0.00";return e=o.status!==this.subscriptionStatusMap.closed&&"object"==typeof o.effectiveEndDate&&"object"==typeof o.nextBillingDate?o.nextBillingDate.format("LL"):"",{type:o.type,startDate:"object"==typeof o.startDate?o.startDate.format("LL"):"",renewDate:e,nextBillingDate:o.nextBillingDate,id:o.id,name:o.prettyName,duration:o.prettyNameDuration,price:t,pendingPrice:n,status:o.status,isClosed:o.status===this.subscriptionStatusMap.closed,isPastDue:o.status===this.subscriptionStatusMap.subscription_went_past_due,effectiveEndDate:o.effectiveEndDate,paymentVendorType:o.paymentVendorType,isDigitalRiverSubscription:this.isPaymentVendorDigitalRiver(o.paymentVendorType),transactions:o.transactions}}.bind(this))},o.SubscriptionsHelper.prototype.getActiveAndPendingSubscriptions=function(e){var t,n;return t=o.Array.filter(this.formatSubscriptionModels(e),function(o){return o.status===this.subscriptionStatusMap.pending}.bind(this)),n=o.Array.filter(this.formatSubscriptionModels(e),function(e){return e.status===this.subscriptionStatusMap.active||e.status===this.subscriptionStatusMap.closed&&void 0!==e.effectiveEndDate&&e.effectiveEndDate.isAfter(o.moment())||e.status===this.subscriptionStatusMap.subscription_went_past_due}.bind(this)),{activeSubs:n,pendingSubs:t}},o.SubscriptionsHelper.prototype.isUserOnActiveButClosedPro=function(e){var t=this.getActiveAndPendingSubscriptions(e);return o.Array.filter(t.activeSubs,function(o){return o.status!==this.subscriptionStatusMap.active}.bind(this)).length>=1&&t.pendingSubs&&0===t.pendingSubs.length},o.SubscriptionsHelper.prototype.isUserCurrentlyOnADigitalRiverSub=function(o){var e=this.getActiveAndPendingSubscriptions(o),t=!1;if(e.activeSubs&&e.activeSubs.length>0){var n=e.activeSubs[0];if(e.pendingSubs&&e.pendingSubs.length>0){var r=e.pendingSubs[0];r&&(t=r.isDigitalRiverSubscription)}else t=n.isDigitalRiverSubscription}return t},o.SubscriptionsHelper.prototype.isUserPastDue=function(e){var t=[],n=this.getActiveAndPendingSubscriptions(e);return(t=o.Array.filter(n.activeSubs,function(o){return o.status===this.subscriptionStatusMap.subscription_went_past_due}.bind(this)))&&t.length>=1},o.SubscriptionsHelper.prototype.hasPurchasedTrialInThePast=function(e){var t=e.toJSON();return o.Array.filter(t,function(o){return o.planId===this.FLICKR_PRO_ANNUAL_TRIAL||o.planId===this.FLICKR_PRO_OLD_ANNUAL_TRIAL}.bind(this)).length>0},o.SubscriptionsHelper.prototype.isOnActiveTrial=function(o){var e=this.getActiveAndPendingSubscriptions(o),t=!1;return e&&e.activeSubs&&e.activeSubs.length>0&&(t=e.activeSubs[0].type===this.FLICKR_PRO_ANNUAL_TRIAL||e.activeSubs[0].type===this.FLICKR_PRO_OLD_ANNUAL_TRIAL),t},o.SubscriptionsHelper.prototype.isOneTimePro=function(o){return o.toJSON().oneTimePro.isOneTimePro},o.SubscriptionsHelper.prototype.getShopperCurrencyAndLocale=function(e){var t="US",n="en_US",r="USD",a=!1;if(!e&&o.config.flickr.geo?(o.config.flickr.geo.countryCode&&(t=o.config.flickr.geo.countryCode),o.config.flickr.geo.eu&&(a=o.config.flickr.geo.eu)):e&&(t=e.countryCode||"US",a=e.eu||!1),a)"GB"===t?(n="en_IE",r="GBP"):(n="en_IE",r="EUR");else switch(t){case"US":n="en_US",r="USD";break;case"CA":n="en_IE",r="CAD";break;default:n="en_IE",r="USD"}return{locale:n,currency:r}},o.SubscriptionsHelper.prototype.canUserSeeDigitalRiver=function(o){return!0},o.SubscriptionsHelper.prototype.getPriceWithCurrency=function(o,e,t){var n=t.replace("_","-");return new Intl.NumberFormat(n,{style:"currency",currency:e}).format(o)},o.SubscriptionsHelper.prototype.doesCountryRequiresSignedInGifting=function(o){return!(!o||!o.countryCode||"VN"!==o.countryCode)}},"@VERSION@",{requires:["moment","timezone-helper","array-extras"],optional:[]});YUI.add("past-due-banner-view",function(e,i){require("hermes-core/flog")(i),new e.SubscriptionsHelper;e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){this.params=e},loadState:function(){return this.appContext.getViewer().signedIn?this.appContext.getModel("subscription-history-list-models",this.appContext.getViewer().nsid).then(function(i){var t=new e.SubscriptionsHelper;this.set("isPastDue",t.isUserPastDue(i))}.bind(this)):(this.set("isPastDue",!1),e.Promise.resolve())},buildContainer:function(){var e="<p>"+this.intlMessage({intlName:"featured-banner.WE_HAD_TROUBLE_PAYMENT"});return e+=' <a href="/account">'+this.intlMessage({intlName:"featured-banner.PLEASE_UPDATE_PAYMENT_PAST_DUE"})+"</a>",e+="</p>",this.setContainerWithTemplate("basic-banner",{message:e,additionalClasses:"head-banner-style"}),this},activate:function(){var e=this.get("container");this.registerEventHandler(e.one(".button.dismiss").on("click",this.dismissBanner.bind(this))),this.fire("activated")},dismissBanner:function(i){var t=new Date;t.setTime(t.getTime()+828e5),this.appContext.setCookie({cookieName:e.config.flickr.banners.dismiss_past_due_banner_name,cookieValue:1,expires:t,path:"/"}),this.fire("dismiss")},isABlacklistedView:function(){var e=this.appContext.flapp.get("activeView").name;return!!(e&&["products-pro-2018-view","account-settings-view"].indexOf(e)>-1)},canShowBanner:function(){var i=!1;return this.appContext.getViewer().signedIn&&this.get("isPastDue")&&!this.appContext.getCookie(e.config.flickr.banners.dismiss_past_due_banner_name)&&!this.isABlacklistedView()&&(i=!0),i}})},"@VERSION@",{requires:["flickr-view","user-limits-helper","person-models","person-profile-models","subscriptions-helper"],langBundles:["featured-banner"]});YUI.add("global-nav-view",function(e,t){e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){var i,n;if(void 0===t.enableBrowserUpgradeBanner&&(t.enableBrowserUpgradeBanner=!0),this.set("showBrowserUpgradeBanner",!1),YUI.Env.isServer&&t.enableBrowserUpgradeBanner){var o=this.appContext.request.headers["user-agent"],a=e.BrowserSupport.isUnsupportedBrowser(o),s=e.BrowserSupport.isBot(o),r=e.BrowserSupport.isSharingBot(o);!a||s||r||this.set("showBrowserUpgradeBanner",!0)}if(!YUI.Env.isServer){var l=e.StorageHelper.getItem("hasDismissedBrowserUpgradeBanner",!0);l&&"true"===l&&this.set("showBrowserUpgradeBanner",!1)}return""===this.get("container").get("innerHTML")&&this.setContainerHTML('<div class="global-nav-content"></div>'),this.appStateParams=t,this.themeClass=t.theme||"default-theme",i=this.appContext.getLocation(),n=t.modelParams&&t.modelParams.apiParams?t.modelParams.apiParams:i.href,this.searchUrl=new e.SearchUrl(n,this.appContext,t.searchType),this.appContext.flipper.isFlipped("enable-signed-out-cta-test")&&(this.signedOutTest=!0),this.appContext.flipper.isFlipped("enable-sign-up-interstitial-test")&&"en-us"===this.appContext.lang.toLowerCase()&&(this.signUpInterstitialTest=!0),!this.appContext.flipper.isFlipped("enable-sign-up-rail-test")||"en-us"!==this.appContext.lang.toLowerCase()||this.appContext.getViewer().signedIn||t.isSOHP||(this.signUpRailTest=!0),this.isSOHP=t.isSOHP,this.hideBanner=t.isSearchResults,this.isRefencingAnnouncementPage=t.isRefencingAnnouncementPage,t.featuredToastConfig={id:"upload-limit-warning-toast",showOnActivate:!1},this.uploadLimitDismissHours=48,this},subviewConfig:{"search-autosuggest-field-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,isSOHP:this.isSOHP},"account-menu-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"notifications-menu-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,disabled:function(){return!this.appContext.flipper.isFlipped("notifications-menu")}},"browser-upgrade-banner-view":{requiredToShowOnServer:!0,requiredToShowOnClient:!1,dealbreaker:!1,disabled:function(){return!this.get("showBrowserUpgradeBanner")}},"person-menu-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,containerSelector:"#content",excludeSelectors:[".c-account-menu"],disabled:function(){return!(this.appContext.flipper.isFlipped("enable-hover-account-menu")&&this.appContext.flipper.isFlipped("rebootify-group-discussions-list"))}},"group-menu-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,containerSelector:"#content",excludeSelectors:[".c-account-menu"],disabled:function(){return!(this.appContext.flipper.isFlipped("enable-hover-account-menu")&&this.appContext.flipper.isFlipped("rebootify-group-discussions-list"))}},"signup-rail-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,additionalViewClasses:["collapsed"],disabled:function(e){return e.isMobile||!this.signUpRailTest}},"flickr-chat-center-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,disabled:function(e){return!this.appContext.flipper.isFlipped("flickr-chat")||!this.appContext.getViewer().signedIn}},"partner-account-banner-view":{requiredToShowOnServer:!1,requiredToShowOnClient:!1},"featured-toast-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1},"mega-limit-overlay-view":{requiredToShowOnServer:!1,requiredToShowOnClient:!1}},loadState:function(){var t=this,i=this.appContext.getViewer(),n=[];return i.signedIn?(n.push(this.appContext.getModel("person-models",i.nsid).then(function(e){t.set("viewer",e),t.elementStates=t.setElementStates(t.appStateParams)})),n.push(this.appContext.getModel("person-profile-models",i.nsid).then(function(e){t.profileModel=e}))):this.elementStates=this.setElementStates(this.appStateParams),e.Promise.all(n).then(function(){t.get("viewer");!YUI.Env.isServer&&t.appContext.flipper.isFlipped("enable-feedback-modal")&&"en-US"===t.appContext.lang&&!localStorage.getItem("feedbackModalSeen12_18")&&t.appContext.hasClientSideRouted()&&"photostream-route"!==this.appContext.routeConfig.module&&(t.meetsFeedbackCriteria=!0),YUI.Env.isServer||!t.appContext.flipper.isFlipped("enable-post-outage-message")||localStorage.getItem("backOnlineModalSeen05_19")||(t.meetsBackOnlineCriteria=!0)})},buildContainer:function(){var t,i={},n=this.appContext.getViewer().signedIn;return this.get("viewer")&&(i=e.merge(this.get("viewer").toJSON(),{urls:e.URLHelper.generatePersonUrls(this.get("viewer"))})),t={theme:this.themeClass,"show-browser-upgrade-banner":this.get("showBrowserUpgradeBanner"),showNotificationsMenu:!1,viewer:i,isSignedIn:n,elements:this.elementStates,isRefencingAnnouncementPage:this.isRefencingAnnouncementPage,showFeaturedToast:(this.appContext.flipper.isFlipped("enable-upload-limit-warning")||this.appContext.flipper.isFlipped("enable-upload-limit-messages"))&&this.appContext.getViewer().signedIn},this.appContext.flipper.isFlipped("notifications-menu")&&n&&(t["notifications-menu-view"]=this.subviews["notifications-menu-view"].get("container"),t.showNotificationsMenu=!0),this.setContainerWithTemplate("global-nav",t),this},activate:function(){var i,n,o=this,a=this.get("container");if(n=["photo-page-ad-scrappy-view","sohp-view"],i=this.appContext.flapp.get("activeView").name,this.contentContainer=a.one(".global-nav"),a.one(".mobile-nav-toggle")&&(this.navDrawer=a.one(".mobile-nav-drawer"),this.navDrawerOverlay=a.one(".mobile-nav-drawer-overlay"),this.registerEventHandler(a.one(".mobile-nav-toggle").on("click",function(e){o.navDrawerShown?o.hideMobileNavDrawer():o.showMobileNavDrawer()})),this.registerEventHandler(this.navDrawer.delegate("click",this.handleDrawerItemClick.bind(this),".mobile-nav-menu-item"))),a.one(".mobile-search-button")?(this.registerEventHandler(a.one(".mobile-search-button").on("click",function(t){e.rapidTracker.beacon(o.name,"mobile-nav-search");var i=o.get("container");o.contentContainer.addClass("search-open"),o.fire("parentViewEvent","focus-search-field"),i.one(".flickr-logo-container").addClass("hidden")}.bind(this))),this.registerEventHandler(e.on("add-context-to-search-field",function(e){o.contentContainer.addClass("search-open"),o.fire("parentViewEvent","focus-search-field")},this))):this.registerEventHandler(e.globalEvents.subscribe("window:resize",function(t){var i=e.config.win.innerWidth<=700,n=i?this.appContext.viewportData.getWidth():0,s=i?46:0;i||(o.contentContainer.removeClass("search-open"),a.one(".flickr-logo-container").removeClass("hidden")),o.fire("parentViewEvent","resize-search-field",n-s)}.bind(this))),a.one(".mobile-search-close-button")&&this.registerEventHandler(a.one(".mobile-search-close-button").on("click",function(e){o.contentContainer.removeClass("search-open"),a.one(".flickr-logo-container").removeClass("hidden"),o.fire("parentViewEvent","clear-search-field")}.bind(this))),this.appContext.getViewer().signedIn||(this.signedOutTest&&a.one(".gn-upload .gn-title")&&this.registerEventHandler(a.one(".gn-upload .gn-title").on("click",this.signUpAndUpload.bind(this))),n.indexOf(i)<0&&!this.isMobile&&this.signUpInterstitialTest&&this.startInterstitialTimer()),e.AnchorRepositioner.addOffset(t,a),this.registerEventHandler(a.delegate("keydown",this.toggleSubmenu.bind(this),"a[aria-haspopup=true]")),this.registerEventHandler(a.delegate("keydown",this.enterSubmenu.bind(this),"a[aria-haspopup=true]")),this.registerEventHandler(a.on("keydown",this.goToSubmenuHeading.bind(this),"ul.gn-submenu")),this.registerEventHandler(a.delegate("keydown",this.keyboardNavigation.bind(this),"ul.nav-menu")),this.registerEventHandler(a.delegate("mouseup",this.toggleAriaExpanded.bind(this),"a[aria-haspopup=true]")),this.showFeedbackModal(),this.meetsBackOnlineCriteria&&this.showBackOnlineModal(),this.toastSubview=this.subviews["featured-toast-view"],this.toastSubview.isActivated?o.setupToast():this.toastSubview.on("activated",function(){o.setupToast()}),e.on("accountCard:overLimitLearnMoreClick",function(){o.setupToast(!0)}),this.appContext.flipper.isFlipped("enable-photo-prints")&&(this.registerEventHandler(a.one(".gn-create .prints-button").on("click",this.handlePrintClick.bind(this))),this.registerEventHandler(a.one(".mobile-nav-drawer .prints-button").on("click",this.handlePrintClick.bind(this)))),this.appContext.flipper.isFlipped("enable-outage-banner")&&!this.appContext.getCookie(e.config.flickr.outage.dismiss_outage_banner_cookie_name))this.createOutageWarningBanner();else{var s=this.appContext.getViewer();if(s.signedIn){if(this.get("viewer")&&this.get("viewer").getValue("isPro"))return this.appContext.getModel("subscription-history-list-models",s.nsid).then(function(t){(new e.SubscriptionsHelper).isUserPastDue(t)?this.createPastDueBanner():this.createLoginMigrationBanner()}.bind(this));this.createLoginMigrationBanner()}else this.createLoginMigrationBanner()}return this},showBackOnlineModal:function(){var t,i=this.templates("back-online-modal-view")({}),n=new e.Views.FluidModal({appContext:this.appContext,noScroll:!0,hideModalOverlay:!1,dismissOnOverlayClick:!0,maxHeight:!1,showHeader:!1,showFooter:!1,width:450,contentPadding:0,showCancelX:!1,htmlMessage:i});n.show(),n.on("activated",function(){(t=n.get("container").one(".accept-button")).on("click",function(e){n.close()})}),n.on("close",function(){localStorage.setItem("backOnlineModalSeen05_19",!0)})},showFeedbackModal:function(){var t=this;if(this.meetsFeedbackCriteria){var i,n=this.templates("feedback-modal-view")({}),o=new e.Views.FluidModal({appContext:this.appContext,noScroll:!0,hideModalOverlay:!1,maxHeight:!1,showFooter:!1,classList:"modal-restyle",width:560,htmlMessage:n}),a=[];return this.appContext.getViewer().signedIn&&(this.get("viewer").getValue("isPro")&&a.push(this.appContext.getModel("person-proStatus-models",t.get("viewer").id).then(function(e){t.proStatusModel=e})),a.push(this.appContext.getModel("person-profile-models",t.get("viewer").id).then(function(e){t.profileModel=e}))),e.Promise.all(a).then(function(){o.show(),o.on("activated",function(){i=o.get("container").one(".accept-button"),o.get("container").one(".cancel-button").on("click",function(e){o.close()}),i.on("click",function(e){var n,a,s,r,l="http://v2.decipherinc.com/survey/selfserve/2225/180900?list=1",p=t.appContext.getViewer().signedIn?"yes":"no";i.setAttribute("disabled"),t.appContext.getViewer().signedIn&&(n=t.get("viewer").getValue("isPro")?"pro":"free",s=t.get("viewer").getValue("dateCreated").year()),t.proStatusModel&&(r=1e3*t.proStatusModel.toJSON().firstStart-new Date("November 1, 2018").getTime()>0?"yes":"no"),t.profileModel&&(a=t.profileModel.getValue("photoCount")),n&&(l+="&account_type="+encodeURIComponent(n)),l+="&logged_in="+encodeURIComponent(p),a&&(l+="&number_of_photos="+encodeURIComponent(a)),s&&(l+="&start="+encodeURIComponent(s)),r&&(l+="&newp="+encodeURIComponent(r)),window.open(l,"_blank"),o.close()})}),o.on("close",function(){localStorage.setItem("feedbackModalSeen12_18",!0)})})}},clearKeyboardFocus:function(e){this.get("container").all(".has-keyboard-focus").removeClass("has-keyboard-focus"),this.get("container").all(".nav-menu a[aria-expanded=true]").setAttribute("aria-expanded","false")},toggleAriaExpanded:function(e){e.target.setAttribute("aria-expanded","false"===e.target.getAttribute("aria-expanded")?"true":"false")},enterSubmenu:function(e){if(40===e.keyCode){e.preventDefault();var t=e.target.next("ul");t&&t.hasClass("has-keyboard-focus")&&t.one(":first-child").one(":first-child").focus()}},toggleSubmenu:function(e){var t=e.keyCode;if(13===t||32===t){e.preventDefault();var i=e.target.next("ul");i&&(i.hasClass("has-keyboard-focus")?this.clearKeyboardFocus():(i.addClass("has-keyboard-focus"),e.target.setAttribute("aria-expanded","true")))}},goToSubmenuHeading:function(e,t){var i;(t||27===e.keyCode)&&(t||this.clearKeyboardFocus(),e.target.hasClass("gn-submenu")?i=e.target.previous("a"):e.target.ancestor("ul.gn-submenu")&&(i=e.target.ancestor("ul.gn-submenu").previous("a")),i&&i.focus())},keyboardNavigation:function(e){var t=e.keyCode,i=9===t&&e.shiftKey,n=9===t&&!e.shiftKey;e.target.hasClass("gn-title")?(i=(37===t||i)&&e.target.ancestor("li").previous("li"),n=(39===t||n)&&!!e.target.ancestor("li").next("li"),i?(this.clearKeyboardFocus(),this.focusOnPreviousItem(e)):!n||e.target.next("ul")&&e.target.next("ul").hasClass("has-keyboard-focus")||(this.clearKeyboardFocus(),this.focusOnNextItem(e))):38===t||i?this.focusOnPreviousItem(e):(40===t||n)&&this.focusOnNextItem(e)},focusOnPreviousItem:function(e){e.preventDefault();var t=e.target.ancestor("li").previous("li:not(.divider)");t?t.one(":first-child").focus():e.target.ancestor("ul.gn-submenu")&&this.goToSubmenuHeading(e,!0)},focusOnNextItem:function(e){e.preventDefault();var t=e.target.ancestor("li").next("li:not(.divider)");t&&t.one(":first-child").focus()},startInterstitialTimer:function(){var t,i=this,n=!1;(t=e.StorageHelper.getItem("signUpInterstitialSeen"))?(t=e.moment(t,"x"),e.moment().subtract(2,"days")>t&&(n=!0)):n=!0,n&&(this.signUpInterstitialTimer=setTimeout(function(){if(!e.OverlayManager.hasOverlay()&&e.config.win.innerWidth>700){new e.Views.SignUpInterstitial({appContext:i.appContext}).show(),e.StorageHelper.setItem("signUpInterstitialSeen",e.moment().format("x"))}},4e3))},signUpAndUpload:function(t){var i,n=e.url("/upload/"),o=this.intlMessage({intlName:"global-nav.UPLOAD_MODAL_SIGNUP_TITLE"}),a=this.intlMessage({intlName:"global-nav.UPLOAD_MODAL_SIGNUP_MESSAGE"});t.halt(),e.rapidTracker.beacon(this.name,"uploadButtonClick"),(i=new e.Views.SignUpModal({appContext:this.appContext,signUpHeaderClass:"signup-upload",signUpTitle:o,signUpMessage:a,beaconPrefix:"upload"})).on("signUpClick",function(t){e.SigninHelper._redirectToSignUp("upload",{postLoginUrl:n})}),i.on("signInClick",function(t){e.SigninHelper._redirectToSignin("upload",{postLoginUrl:n})}),i.show()},executeSearch:function(e){var t,i=this.get("container").one("#gn-search-field").getDOMNode();t=this.searchUrl.createNewSearch(i.value).getURL(),e.halt(),this.appContext.flapp.navigate(t)},setElementStates:function(e){var t=this.appContext.getViewer(),i={you_link:!1,you_menu:!1,contacts_menu:!1,groups_menu:!1,explore_menu:!1,weekly_flickr:!1,create_link:!0,get_pro_link:!0,upload_icon:!1,account_menu:!1,search_bar:!1,signup_link:!1,signin_link:!1,right_side_signup:!1,vr_link:!0};return e.isSOHP&&!t.signedIn?(i.search_bar=!0,i.signin_link=!0,i.signup_link=!0,i.create_link=!1,i.get_pro_link=!1):t.signedIn?(i.you_menu=!0,i.explore_menu=!0,i.upload_icon=!0,i.search_bar=!0,i.account_menu=!0):(i.signup_link=!0,i.explore_menu=!0,i.upload_icon=!0,i.search_bar=!0,i.signin_link=!0),this.get("viewer")&&this.get("viewer").getValue("isPro")&&(i.stats=!0,i.get_pro_link=!1),"en-us"===this.appContext.lang.toLowerCase()&&(i.weekly_flickr=!0),this.signedOutTest&&(i.right_side_signup=!0),this.appContext.flipper.isFlipped("enable-photo-prints")&&(i.create_link=!1,i.prints_menu=!0),i},isExpiringPartnerAccount:function(){var e=this.get("viewer").getValue("expiringPartner");return this.appContext.flipper.isFlipped("enable-partner-account-banner")&&e&&-1===["embedr-route","site-key-route","browser-upgrade-interstitial-route","products-marketplace-eol-route","products-account-payouts-route","error-route"].indexOf(this.appContext.routeConfig.module)},handleToastPrimaryActionClick:function(t){var i=t&&t.clickEvent?t.clickEvent.target.getAttribute("href"):null;this.setToastDismissCookie(),i?e.config.win.location.href=i:this.toastSubview.dismiss()},handleToastSecondaryActionClick:function(t){var i=t&&t.clickEvent?t.clickEvent.target.getAttribute("href"):null;this.setToastDismissCookie(),i?e.config.win.location.href=i:this.toastSubview.dismiss()},setToastDismissCookie:function(){var e=new Date;e.setTime(e.getTime()+60*this.uploadLimitDismissHours*60*1e3),this.dontSetUploadLimitDismissCookie||this.appContext.setCookie({cookieName:this.toastDismissCookieName,cookieValue:1,expires:e,path:"/"})},setupToast:function(t){var i=!1,n=!1;this.toastSubview&&(this.appContext.flipper.isFlipped("enable-upload-limit-messages")?e.UserLimitsHelper.isOverARRLimit(this.profileModel,this.appContext)?(n=!0,!t&&this.appContext.flipper.isFlipped("enable-photo-limit-overlay")&&(n="photostream-route"!==this.appContext.routeConfig.module&&"photo-route"!==this.appContext.routeConfig.module&&"products-flickrpro-route"!==this.appContext.routeConfig.module&&!this.appContext.getCookie(e.config.flickr.upload_blocking.dismiss_photo_limit_overlay_cookie_name)),!t&&this.appContext.flipper.isFlipped("enable-mega-limit-overlay")&&(n=this.appContext.getCookie(e.config.flickr.upload_blocking.dismiss_photo_limit_overlay_cookie_name)),n&&(this.toastSubview.setup({htmlContent:this.templates("upload-limit-message")({title:this.intlMessage({intlName:"upload-blocking.OVER_UPLOAD_LIMIT_HEAD_FINAL"}),description:this.intlMessage({intlName:"upload-blocking.OVER_UPLOAD_LIMIT_COPY_FINAL",limitCount:e.config.flickr.account.photo_limit.toLocaleString(this.appContext.lang,{maximumFractionDigits:0})}),primaryActionText:this.intlMessage({intlName:"common.GET_PRO"}),secondaryActionText:t?this.intlMessage({intlName:"common.DISMISS"}):this.intlMessage({intlName:"common.REMIND_ME_LATER"})}),classList:["urgent"]}),this.dontSetUploadLimitDismissCookie=t,this.uploadLimitDismissHours=e.config.flickr.upload_blocking.dismiss_over_upload_limit_message_cookie_hours,this.toastDismissCookieName=e.config.flickr.upload_blocking.dismiss_over_upload_limit_message_cookie_name,i=!0)):e.UserLimitsHelper.hasReachedUploadLimit(this.profileModel,this.appContext)?(this.toastSubview.setup({htmlContent:this.templates("upload-limit-message")({title:this.intlMessage({intlName:"upload-blocking.AT_UPLOAD_LIMIT_HEAD"}),description:this.intlMessage({intlName:"upload-blocking.AT_UPLOAD_LIMIT_COPY_SHORT",limitCount:e.config.flickr.account.photo_limit.toLocaleString(this.appContext.lang,{maximumFractionDigits:0}),limitedImagesUrl:"https://blog.flickr.net/en/2018/12/17/important-service-updates-and-dates-to-remember/?utm_campaign=flickr-launch-15&utm_source=Flickr&utm_medium=product&utm_content=big-blue",upgradeToProUrl:"/account/upgrade/pro"}),primaryActionText:this.intlMessage({intlName:"common.GET_PRO"}),secondaryActionText:this.intlMessage({intlName:"common.REMIND_ME_LATER"})})}),this.uploadLimitDismissHours=e.config.flickr.upload_blocking.dismiss_at_upload_limit_message_cookie_hours,this.toastDismissCookieName=e.config.flickr.upload_blocking.dismiss_at_upload_limit_message_cookie_name,i=!0):e.UserLimitsHelper.isNearUploadLimit(this.profileModel,this.appContext)&&(this.toastSubview.setup({htmlContent:this.templates("upload-limit-message")({title:this.intlMessage({intlName:"upload-blocking.UPLOADS_LOCKED_SOON_HEAD"}),description:this.intlMessage({intlName:"upload-blocking.UPLOADS_LOCKED_SOON_COPY",limitCount:e.config.flickr.account.photo_limit.toLocaleString(this.appContext.lang,{maximumFractionDigits:0}),limitedImagesUrl:"https://blog.flickr.net/en/2018/12/17/important-service-updates-and-dates-to-remember/?utm_campaign=flickr-launch-15&utm_source=Flickr&utm_medium=product&utm_content=big-blue",upgradeToProUrl:"/account/upgrade/pro"}),primaryActionText:this.intlMessage({intlName:"common.GET_PRO"}),secondaryActionText:this.intlMessage({intlName:"common.REMIND_ME_LATER"})})}),this.uploadLimitDismissHours=e.config.flickr.upload_blocking.dismiss_near_upload_limit_message_cookie_hours,this.toastDismissCookieName=e.config.flickr.upload_blocking.dismiss_near_upload_limit_message_cookie_name,i=!0):this.appContext.flipper.isFlipped("enable-upload-limit-warning")&&e.UserLimitsHelper.isNearUploadLimit(this.profileModel,this.appContext)&&(this.templates("upload-limit-warning")({}),this.toastSubview.setup({htmlContent:this.templates("upload-limit-warning")({})}),this.uploadLimitDismissHours=e.config.flickr.upload_blocking.dismiss_upload_limit_warning_cookie_hours,this.toastDismissCookieName=e.config.flickr.upload_blocking.dismiss_upload_limit_warning_cookie_name,i=!0),i&&this.toastDismissCookieName&&(t||!this.appContext.getCookie(this.toastDismissCookieName))&&(this.toastSubview.show(),this.toastSubview.on("primaryActionClicked",this.handleToastPrimaryActionClick.bind(this)),this.toastSubview.on("secondaryActionClicked",this.handleToastSecondaryActionClick.bind(this))))},handlePrintClick:function(){this.showPrintSelector()},showPrintSelector:function(){var t=this,i=[{id:"photostream",name:this.intlMessage({intlName:"common.PHOTOSTREAM"}),value:"photostream",selected:!0},{id:"sets",name:this.intlMessage({intlName:"common.ALBUMS"}),value:"sets"},{id:"upload",name:this.intlMessage({intlName:"global-nav.UPLOAD"}),value:"upload"}],n=[{id:"photostream",name:this.intlMessage({intlName:"common.PHOTOSTREAM"}),value:"photostream",selected:!0},{id:"sets",name:this.intlMessage({intlName:"common.ALBUMS"}),value:"sets"},{id:"upload",name:this.intlMessage({intlName:"global-nav.UPLOAD"}),value:"upload"}],o=[{id:"photostream",name:this.intlMessage({intlName:"common.PHOTOSTREAM"}),value:"photostream",selected:!0},{id:"sets",name:this.intlMessage({intlName:"common.ALBUMS"}),value:"sets"}],a={appContext:this.appContext,searchable:{yours:!0,contacts:!1,everyone:!1,marketplace:!1}};this.printSelector=new e.Views["photo-selector-view"](a),this.printSelectorModal=new e.Views.FluidModal({appContext:this.appContext,dismissOnOverlayClick:!0,dismissOnActionClick:!1,showBodyLines:!0,showCancelButton:!1,showCancelX:!0,title:"",navBarView:new e.Views["fluid-modal-nav-bar-view"]({appContext:this.appContext,links:i,enableSearch:!0,breakpointConfig:[{maxWidth:700,links:n,enableSearch:!1},{maxWidth:500,links:o,enableSearch:!1}]}),actionButtonLabel:"TMP Buy prints",actionButtonDisabled:!0,subview:this.printSelector,width:Math.round(.8*Math.max(1280,e.config.win.innerWidth)),height:Math.round(e.config.win.innerHeight-60),fullWindow:!0,classList:"photo-selector",hideModalOverlay:!1}),this.printSelectorModal.show(),this.printSelectorModal.registerEventHandler(e.on("photoSelector:selected",function(e){t.printSelectorModal.enableActionButton()})),this.printSelectorModal.registerEventHandler(e.on("photoSelector:unselected",function(e){t.printSelectorModal.disableActionButton()})),this.printSelectorModal.on("actionClick",function(i){var n=t.printSelector.get("selected");t.registerPrintWithId(n).then(function(t){e.config.win.location.href=""})})},registerPrintWithId:function(t){var i={userId:this.appContext.getViewer().nsid,photoId:t};return e.Promise.resolve(i)},handleDrawerPageMouseDown:function(e){var t=e.target;t.ancestor(".mobile-nav-drawer",!0)||t.ancestor(".mobile-nav-toggle",!0)||this.hideMobileNavDrawer()},handleDrawerItemClick:function(e){this.hideMobileNavDrawer()},showMobileNavDrawer:function(){var t=this;this.get("container");this.contentContainer.addClass("drawer-open"),this.navDrawerShown=!0,this.navDrawer.addClass("shown"),clearTimeout(this.navDrawerOverlayHideTimeout),this.navDrawerOverlay&&(this.navDrawerOverlay.addClass("displayed"),setTimeout(function(){t.navDrawerOverlay.addClass("shown")},10)),this.drawerPageClickHandler||setTimeout(function(){t.drawerPageClickHandler=e.on(["mousedown","touchstart"],t.handleDrawerPageMouseDown.bind(t)),t.registerEventHandler(t.drawerPageClickHandler)},10)},hideMobileNavDrawer:function(){var e=this;this.get("container");this.contentContainer.removeClass("drawer-open"),this.navDrawerShown=!1,this.navDrawer.removeClass("shown"),this.navDrawerOverlay&&(this.navDrawerOverlay.removeClass("shown"),this.navDrawerOverlayHideTimeout=setTimeout(function(){e.navDrawerOverlay.removeClass("displayed")},500)),this.drawerPageClickHandler&&(this.detachRegisteredEvent(this.drawerPageClickHandler),this.drawerPageClickHandler=void 0)},createOutageWarningBanner:function(){var e=this;this.appContext.getView("outage-banner-view",{appContext:this.appContext}).then(function(t){e.createBanner(t)})},createPastDueBanner:function(){var e=this;this.appContext.getView("past-due-banner-view",{appContext:this.appContext}).then(function(t){e.createBanner(t)})},createLoginMigrationBanner:function(){var e=this;this.appContext.getView("login-migration-banner-view",{appContext:this.appContext}).then(function(t){e.createBanner(t)})},createBanner:function(t){var i=this,n=this.get("container").one(".nav-banner-container");this.appContext.getView("banner-view",{appContext:this.appContext,subview:t}).then(function(t){return i.bannerView=t,i.bannerView.on("subviewActivated",function(){e.fire("globalNav:bannerSubviewActivated")}),i.bannerView.on("dismissed",function(){i.bannerView.get("container").remove(),i.bannerView.destroy(),e.fire("globalNav:bannerDismissed")}),i.bannerView.initialize()}).then(function(){var e=i.bannerView.get("container");return n.empty(),n.appendChild(e),i.bannerView.activate()})},destructor:function(){clearTimeout(this.signUpInterstitialTimer),e.AnchorRepositioner.removeOffset(t)}})},"@VERSION@",{requires:["flickr-view","hermes-template-global-nav","hermes-template-feedback-modal-view","hermes-template-back-online-modal-view","hermes-template-upload-limit-warning","hermes-template-upload-limit-message","search-url","search-autosuggest-field-view","querystring-parse-simple","querystring-stringify-simple","notifications-menu-view","url-helper","person-menu-view","group-menu-view","browser-support","fluid-modal-view","signup-modal-view","signup-interstitial-view","signin-helper","storage-helper","partner-account-banner-view","featured-toast-view","user-limits-helper","photo-selector-view","fluid-modal-nav-bar-view","mega-limit-overlay-view","banner-view","login-migration-banner-view","past-due-banner-view"],langBundles:["global-nav","common","search","migration-outage","upload-blocking"]});YUI.add("hermes-lang-global-nav",function(o,e){o.Intl.add("hermes/global-nav","en-US",{FLICKR_LOGO_ALT:["Flickr logo. If you click it, you'll go home"],YOUR_PHOTOSTREAM:["Your Photostream"],FOLLOWING:["Following"],PHOTOS_OF:["Photos of"],PHOTOS_FROM:["Photos from"],LIST:["List"],COMMUNITIES:["Communities"],GROUPS_LIST:["Groups List"],SEARCH_GROUPS:["Search Groups"],RECENT_DISCUSSIONS:["Recent Discussions"],CREATE_A_GROUP:["Create a Group"],RECENT_PHOTOS:["Recent Photos"],THE_COMMONS:["The Commons"],GETTY_COLLECTION:["Getty Collection"],GALLERIES:["Galleries"],FLICKR_GALLERIES:["Flickr Galleries"],WORLD_MAP:["World Map"],APP_GARDEN:["App Garden"],THE_WEEKLY_FLICKR:["The Weekly Flickr"],FLICKR_BLOG:["Flickr Blog"],UPLOAD:["Upload"],SIGN_IN:["Sign In"],SEARCH:["Search"],CAMERA_FINDER:["Camera Finder"],RECENT_ACTIVITY:["Recent Activity"],STATS:["Stats"],ORGANIZE:["Organize"],CREATIONS:["Creations"],FIND_FRIENDS:["Find Friends"],GROUPS:["Groups"],PEOPLE:["People"],CAMERAROLL:["Camera Roll"],CREATE:["Create"],CREATE_NEW:["New Creation"],CREATE_MY_WALLART:["My Wall Art"],CREATE_MY_PHOTOS_BOOKS:["My Photo Books"],CREATE_ORDER_HISTORY:["My Order History"],UPLOAD_MODAL_SIGNUP_TITLE:["Upload your photos securely and privately!"],UPLOAD_MODAL_SIGNUP_MESSAGE:["Join Flickr to unlock 1,000GB of free photo storage."],HOME:["Home"],LOG_IN:["Log In"]})},"@VERSION@",{requires:["intl"]});YUI.add("hermes-lang-migration-outage",function(e,a){e.Intl.add("hermes/migration-outage","en-US",{MAY_UNAVAILABLE_FOR_MAINTENANCE:["On May ","${dateNumber}"," at ","${time}"," Flickr will be unavailable for maintenance."],LEARN_MORE_HERE:["Learn more here."],PANDA_DOWNTIME_HEADLINE:["Flickr is temporarily down for scheduled maintenance."],PANDA_DOWNTIME_DESCRIPTION_1:["Sad, sad panda wants photos!"],PANDA_DOWNTIME_DESCRIPTION_2:['<a class="announcement-link" href="',"${announcementUrl}",'">As we previously announced</a>, Flickr will be down for a few hours while we move a huge piece of infrastructure to our new hosting platform, but that’s no reason to frown. Go out and take some photos, then join the Flickr Good Panda <a class="contest-link"  href="',"${contestUrl}",'">photo contest</a>.'],PANDA_DOWNTIME_DESCRIPTION_3:['Print out this page and cut out the panda. Then take a photo of the panda on an adventure somewhere. When the site is back up, upload your photo to <a href="',"${groupUrl}",'">Good Panda photo contest group</a> and tag it with "',"${contestTag}",'".'],PANDA_DOWNTIME_DESCRIPTION_4:["Team Flickr will pick ten winners in the next few days and each winner will get a free year of Pro."],PANDA_DOWNTIME_DESCRIPTION_5:['You can also check <a href="https://status.flickr.net/">https://status.flickr.net/</a> for updates.'],BACK_ONLINE:["We’re back online"],BACK_ONLINE_DESCRIPTION:['We just finished re-engineering Flickr’s underlying infrastructure. You may come across a few parts of the site that aren’t working perfectly, but we will be addressing them soon. You can always share your feedback with us on the <a class="help-forum-link" href="',"${helpForumUrl}",'">Help Forum</a> or at the <a class="help-center-link" href="',"${helpCenterUrl}",'">Flickr Help Center</a>.'],CAMERAROLL_DOWN_HEADLINE:["Camera Roll isn’t feeling so great."],CAMERAROLL_DOWN_DESCRIPTION_1:['<a class="announcement-link" href="',"${announcementUrl}",'">As we previously announced</a>, our beloved Camera Roll needed a little rest and relaxation. We’ve sent it on a vacation of sorts to an all-inclusive, luxurious Camera Roll-only getaway to get it back to full steam. You can stay updated on the progress <a class="progress-link" href="',"${progressUrl}",'">here</a>.'],CAMERAROLL_DOWN_DESCRIPTION_2:['We’ve temporarily replaced Camera Roll with the Photostream Edit view. For batch photo edits and organization, you can use <a href="/photos/organize">Organizr</a>.'],CAMERAROLL_WANT_TO_SHARE:["Want to share your work with the greatest community of photographers in the world?"],WHERES_CAMERAROLL:["Where’s Camera Roll?"],BATCH_EDIT_IN_ORGANIZR:["Batch edit in Organizr"]})},"@VERSION@",{requires:["intl"]});YUI.add("empty-photo-page-view",function(e){e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this},subviewConfig:{"global-nav-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0},"footer-full-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0}},additionalViewClasses:function(){var e=[];return!this.appContext.getViewer().signedIn&&this.appContext.flipper.isFlipped("global-nav-enabled")&&e.push("has-global-nav"),e},buildContainer:function(){return this.setContainerWithTemplate("empty-photo-page"),this}},{ATTRS:{spaceid:{value:792600606}}})},"@VERSION@",{requires:["flickr-view","hermes-template-empty-photo-page","overflow-helper","url"],optional:["global-nav-view"],langBundles:["common","photo-page-scrappy"]});YUI.add("hermes-template-photo-page-lightbox",function(e,a){var t=e.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(e,a,t,l,r){return e.escapeExpression((t.outlet||a&&a.outlet||t.helperMissing).call(null!=a?a:{},null!=a?a["photo-well-view"]:a,{name:"outlet",hash:{},data:r}))+"\n"},useData:!0}),l={};e.Array.each([],function(a){var t=e.Template.get("hermes/"+a);t&&(l[a]=t)}),e.Template.register("hermes/photo-page-lightbox",function(a,r){return r=r||{},r.partials=r.partials?e.merge(l,r.partials):l,t(a,r)})},"@VERSION@",{requires:["template-base","handlebars-base"]});